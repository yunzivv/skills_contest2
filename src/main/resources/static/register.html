<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <title>고객 등록</title>
</head>
<body style="margin: 0; padding: 0;">
<div style="width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; background-color: #eeeeee;">

    <form action="/api/register" method="post" id="registerForm"
          style="width: 50%; height: 50%; margin-bottom: 50px;
               text-align: center; padding: 30px;
               border-radius: 10px; background-color: white;">
        <!-- input-->
        <div style="height: 70%; display:flex; flex-direction: column; gap: 10px;">
            <div style="display: flex; justify-content: space-between;">
                고객코드:
                <input name="code" style="width: 50%; padding: 10px;" type="text" disabled>
            </div>
            <div style="display: flex; justify-content: space-between;">
                * 고객명:
                <input name="name" style="width: 50%; padding: 10px;" type="text">
            </div>
            <div style="display: flex; justify-content: space-between;">
                * 생년월일(YYYY-MM-DD):
                <input name="birth" style="width: 50%; padding: 10px;" type="date">
            </div>
            <div style="display: flex; justify-content: space-between;">
                * 연락처:
                <input name="tel" style="width: 50%; padding: 10px;" type="tel">
            </div>
            <div style="display: flex; justify-content: space-between;">
                주소:
                <input name="address" style="width: 50%; padding: 10px;" type="text">
            </div>
            <div style="display: flex; justify-content: space-between;">
                회사:
                <input name="company" style="width: 50%; padding: 10px;" type="text">
            </div>

        </div>

        <!-- button-->
        <div style="height: 30%; display: flex; justify-content: center; align-items: end; gap: 10px;">
            <input id="submit" type="submit" value="추가" style="padding: 10px 20px;
                background-color: #1e5eff; color: white; border-radius: 3px; border: 1px solid #707070;">
            <a href="/management.html"
               style="display:inline-block; background-color: #efefef; border-radius:3px; font-size: 0.8rem;
               padding: 11px 20px; text-decoration:none; color:#111; border:1px solid #707070;">
                닫기
            </a>
        </div>
    </form>

    <style>
        a:hover {
            background-color: #dddddd !important;
        }

        #submit:hover {
            background-color: #1a53e1 !important;
        }
    </style>

    <script>
        const form = document.getElementById('registerForm');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!form.reportValidity()) {
                alert('필수 항목(*)을 모두 입력하세요.');
                return;
            }

            const body = new URLSearchParams(new FormData(form));
            try {
                const res = await fetch(form.action, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                    body
                });

                const text = await res.text();
                const ok = (text.trim() === 'true');
                if (ok) {
                    alert('고객 추가가 완료되었습니다.');
                    form.reset();
                } else {
                    alert('필수 항목(*)을 모두 입력하세요.');
                }
            } catch (err) {
                alert('필수 항목(*)을 모두 입력하세요.');
                return;
            }
        });
    </script>
</div>
</body>
</html>